<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SAMLConfigBean.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Spring Security ADFS SAML2</a> &gt; <a href="index.source.html" class="el_package">com.github.choonchernlim.security.adfs.saml2</a> &gt; <span class="el_source">SAMLConfigBean.java</span></div><h1>SAMLConfigBean.java</h1><pre class="source lang-java linenums">package com.github.choonchernlim.security.adfs.saml2;

import static com.github.choonchernlim.betterPreconditions.preconditions.PreconditionFactory.expect;
import com.google.common.base.Optional;
import com.google.common.collect.ImmutableSet;
import org.opensaml.saml2.core.AuthnContext;
import org.springframework.core.io.Resource;
import org.springframework.security.saml.userdetails.SAMLUserDetailsService;

import java.util.Set;

/**
 * This class contains all properties that can be configured by Sp using the provided builder class.
 */
public final class SAMLConfigBean {

    /**
     * (REQUIRED) IdP's server name.
     */
    private final String idpServerName;

    /**
     * (REQUIRED) Sp's server name.
     */
    private final String spServerName;

    /**
     * (OPTIONAL) Sp's HTTPS port.
     * &lt;p/&gt;
     * Default is 443.
     */
    private final Integer spHttpsPort;

    /**
     * (OPTIONAL) Sp's context path.
     * &lt;p/&gt;
     * Default is &quot;&quot;.
     */
    private final String spContextPath;

    /**
     * (REQUIRED) Keystore containing app's public/private key and ADFS' certificate with public key.
     */
    private final Resource keystoreResource;

    /**
     * (REQUIRED) Keystore alias.
     */
    private final String keystoreAlias;

    /**
     * (REQUIRED) Keystore password.
     */
    private final String keystorePassword;

    /**
     * (REQUIRED) Keystore private key password.
     */
    private final String keystorePrivateKeyPassword;

    /**
     * (REQUIRED) Where to redirect user on successful login if no saved request is found in the session.
     */
    private final String successLoginDefaultUrl;

    /**
     * (REQUIRED) Where to redirect user on successful logout.
     */
    private final String successLogoutUrl;

    /**
     * Where to redirect user on failed login. This value is set to null, which returns
     * 401 error code on failed login. But, in theory, this will never be used because
     * IdP will handled the failed login on IdP login page.
     * &lt;p/&gt;
     * Default is blank.
     */
    private final String failedLoginDefaultUrl;

    /**
     * For configuring user authorities if needed.
     * &lt;p/&gt;
     * Default is null.
     */
    private final SAMLUserDetailsService samlUserDetailsService;

    /**
     * Determine what authentication methods to use.
     * &lt;p/&gt;
     * To use the order of authentication methods defined by IdP, set as empty set.
     * &lt;p/&gt;
     * To enable Windows Integrated Auth (WIA) cross browsers and OSes, use `CustomAuthnContext.WINDOWS_INTEGRATED_AUTHN_CTX`.
     * &lt;p/&gt;
     * Default is user/password authentication where IdP login page is displayed.
     */
    private final Set&lt;String&gt; authnContexts;

<span class="fc" id="L98">    SAMLConfigBean(final String idpServerName,</span>
                   final String spServerName,
                   final Integer spHttpsPort,
                   final String spContextPath,
                   final Resource keystoreResource,
                   final String keystoreAlias,
                   final String keystorePassword,
                   final String keystorePrivateKeyPassword,
                   final String successLoginDefaultUrl,
                   final String successLogoutUrl,
                   final String failedLoginDefaultUrl,
                   final SAMLUserDetailsService samlUserDetailsService,
                   final Set&lt;String&gt; authnContexts) {

        //@formatter:off
<span class="fc" id="L113">        this.idpServerName = expect(idpServerName, &quot;IdP server name&quot;).not().toBeBlank().check();</span>

<span class="fc" id="L115">        this.spServerName = expect(spServerName, &quot;Sp server name&quot;).not().toBeBlank().check();</span>
<span class="fc" id="L116">        this.spHttpsPort = Optional.fromNullable(spHttpsPort).or(443);</span>
<span class="fc" id="L117">        this.spContextPath = Optional.fromNullable(spContextPath).or(&quot;&quot;);</span>

<span class="fc" id="L119">        this.keystoreResource = (Resource) expect(keystoreResource, &quot;Key store&quot;).not().toBeNull().check();</span>
<span class="fc" id="L120">        this.keystoreAlias = expect(keystoreAlias, &quot;Keystore alias&quot;).not().toBeBlank().check();</span>
<span class="fc" id="L121">        this.keystorePassword = expect(keystorePassword, &quot;Keystore password&quot;).not().toBeBlank().check();</span>
<span class="fc" id="L122">        this.keystorePrivateKeyPassword = expect(keystorePrivateKeyPassword, &quot;Keystore private key password&quot;).not().toBeBlank().check();</span>

<span class="fc" id="L124">        this.successLoginDefaultUrl = expect(successLoginDefaultUrl, &quot;Success login URL&quot;).not().toBeBlank().check();</span>
<span class="fc" id="L125">        this.successLogoutUrl = expect(successLogoutUrl, &quot;Success logout URL&quot;).not().toBeBlank().check();</span>

<span class="fc" id="L127">        this.failedLoginDefaultUrl = Optional.fromNullable(failedLoginDefaultUrl).or(&quot;&quot;);</span>

<span class="fc" id="L129">        this.samlUserDetailsService = samlUserDetailsService;</span>

<span class="fc" id="L131">        this.authnContexts = Optional.fromNullable(authnContexts).or(ImmutableSet.of(AuthnContext.PASSWORD_AUTHN_CTX));</span>
        //@formatter:on
<span class="fc" id="L133">    }</span>

    public String getIdpServerName() {
<span class="fc" id="L136">        return idpServerName;</span>
    }

    public String getSpServerName() {
<span class="fc" id="L140">        return spServerName;</span>
    }

    public Integer getSpHttpsPort() {
<span class="fc" id="L144">        return spHttpsPort;</span>
    }

    public String getSpContextPath() {
<span class="fc" id="L148">        return spContextPath;</span>
    }

    public Resource getKeystoreResource() {
<span class="fc" id="L152">        return keystoreResource;</span>
    }

    public String getKeystoreAlias() {
<span class="fc" id="L156">        return keystoreAlias;</span>
    }

    public String getKeystorePassword() {
<span class="fc" id="L160">        return keystorePassword;</span>
    }

    public String getKeystorePrivateKeyPassword() {
<span class="fc" id="L164">        return keystorePrivateKeyPassword;</span>
    }

    public String getSuccessLoginDefaultUrl() {
<span class="fc" id="L168">        return successLoginDefaultUrl;</span>
    }

    public String getSuccessLogoutUrl() {
<span class="fc" id="L172">        return successLogoutUrl;</span>
    }

    public String getFailedLoginDefaultUrl() {
<span class="fc" id="L176">        return failedLoginDefaultUrl;</span>
    }

    public SAMLUserDetailsService getSamlUserDetailsService() {
<span class="fc" id="L180">        return samlUserDetailsService;</span>
    }

    public Set&lt;String&gt; getAuthnContexts() {
<span class="fc" id="L184">        return authnContexts;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>